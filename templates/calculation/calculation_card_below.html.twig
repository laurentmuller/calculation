{% extends 'calculation/calculation_card.html.twig' %}
{# imports #}
{% import 'macros/_icons.html.twig' as icons %}

{# macros #}
{% macro printItem(item) -%}
{% import 'macros/_properties.html.twig' as properties %}
{%- set texts = {} -%}
{% if item.price == 0 %}
    {%- set texts = texts|merge(['calculationitem.fields.price'|trans]) -%}
{% endif %}
{% if item.quantity == 0 %}
    {%- set texts = texts|merge(['calculationitem.fields.quantity'|trans]) -%}
{% endif %}
{{- properties.line(item.description ~ ' (' ~ texts|join(', ') ~ ')', 'text-danger') -}}
{%- endmacro %}

{# parameters #}
{%- set title        = 'calculation.below.title' -%}
{%- set title_icon   = 'percent' -%}
{%- set empty_list   = 'calculation.below.empty' -%}
{%- set caller       = path(app.request.get('_route')) -%}

{# actions #}
{%- set add_page     = false -%}
{%- set delete_page  = false -%}
{%- set pdf_page     = false -%}
{%- set state_page   = false -%}
{%- set clone_page   = false -%}

{% block search_action %}
{{ icons.linkTable('calculation_below_table') }}
{% endblock %}

{% block card_header -%}
{{ parent() }}
<p class="ml-4 mb-0">{{ 'calculation.below.description'|trans({'%margin%': min_margin|percent}) }}</p>
{% if items|length %}<p class="ml-4 mb-0">{{ 'calculation.below.count'|trans({'%calculations%': items|length}) }}</p>{% endif %}
{%- endblock %}

{%- block card_footer_class '' -%}
{% block card_footer -%}
{{ icons.homepage() }}
{% if items|length %}{{ icons.button_pdf('calculation_below_pdf') }}{% endif %}
{%- endblock %}
