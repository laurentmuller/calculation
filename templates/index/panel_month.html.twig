{# import #}
{% from 'macros/_icons.html.twig' import icon, link %}
{% import 'index/_macros.html.twig' as macros %}
{# macros #}
{% macro cardEntry(month, list_path, min_margin) -%}
<div class="card index-child m-1">
    <div class="card-body card-body-tooltip p-2">
        <div class="card-text">
            {%- set text = month.date|locale_date('none', null, null, 'MMMM Y')|capitalize -%}
            {%- if list_path -%}
                {%- set list_title = 'index.panel_month_title'|trans({'%month%': text}) -%}
                <a href="{{ path(list_path, {'search': month.date|locale_date('none', null, null, 'MM.Y')}) }}" class="card-link stretched-link" title="{{ list_title }}">
                    {{ text }}
                </a>
            {%- else -%}
                <span>{{ text }}</span>
            {%- endif -%}
        </div>
        <div class="h4 fw-normal my-1">
            <span title="{{ 'index.panel_title_total'|trans }}">{{- month.total|integer }}</span> {{ macros.margin(month.margin, min_margin) -}}
        </div>
        <p class="card-text" title="{{ 'index.panel_title_count'|trans }}">
            {{- 'counters.calculations'|trans({'count': month.count}) -}}
        </p>
    </div>
</div>
{%- endmacro %}
{# parameters #}
{%- set list_path = is_granted_calculation ? 'calculation_table' : false -%}
{%- set is_months = months|length -%}
{# content #}
<div class="card card-month mb-2" data-path="{{ path('homepage_hide_month') }}">
    <div class="card-header">
        <div class="d-flex flex-wrap align-items-center gap-1">
            <h1 class="card-title flex-fill">{{ icon('calendar-alt far', 'index.panel_month') }}</h1>
            {%- if list_path and is_months -%}
                {{ link(path('chart_by_month'), null, 'd-print-none', 'chart-column fa-fw', 'index.menu_chart_title') }}
            {%- endif -%}
            <a href="#" class="hide-panel d-print-none" title="{{ 'index.panel_month_hide'|trans }}">
                {{- icon('xmark fa-fw') -}}
            </a>
        </div>
    </div>
    {% if is_months %}
    <div class="card-body index-parent no-gutters p-1">
    {% for month in months %}
        {{ _self.cardEntry(month, list_path, min_margin) }}
    {% endfor %}
    </div>
    {% else %}
        {{ macros.empty() }}
    {% endif %}
</div>
