{# Template to edit an entity. Extends base card template with a form. #}
{% extends 'cards/card_base.html.twig' %}
{% import 'macros/_icons.html.twig' as icons %}

{# parameters #}
{%- set submit_text   = submit_text|default('common.button_ok') -%}
{%- set submit_class  = submit_class|default('btn btn-form btn-primary') -%}
{%- set submit_domain = submit_domain|default(null) -%}
{%- set submit_params = submit_params|default({}) -%}
{%- set action        = action|default(app.request.requestUri) -%}
{%- set form_attr     = form_attr|default({})|merge({ 'id': 'edit-form'}) -%}
{%- if cancel_path is not defined -%}
{%- set cancel_path   = cancelUrl(app.request, item.id|default(0), page_list|default('homepage')) -%}
{%- endif -%}

{% block start_card_container %}
{{ parent() -}}
{% block start_form %}
{{ form_start(form, { 'action': action, 'attr': form_attr }) }}
{% endblock %}
{% endblock %}


{% block card_header %}
{{ parent() -}}
{{ form_errors(form) }}
{%- endblock %}

{% block card_footer -%}
<div class="row">
    <div class="col-md-9">
	{% block actions_form -%} 
        {{ icons.button_submit(submit_text, submit_class, submit_domain, submit_params) }}
        {% if cancel_path|default(false) %}
            {{ icons.button_cancel(cancel_path) }}
        {% endif %}
	{%- endblock %}
    </div>
    <div class="col-md-3 text-md-right">
    {% block required_form -%}
        <small class="text-danger">{{ 'common.required'|trans }}</small>
    {%- endblock %}
    </div>
</div>
{%- endblock %}

{% block end_card_container -%}
{% block end_form -%}{{ form_end(form) }}{%- endblock %}
{{ parent() }}
{%- endblock %}

{% block javascripts -%}
{% if app.debug %}
{{ parent() }}
{{ asset_js('js/vendor/jquery-validate/jquery.validate.js') }}
{{ asset_js('js/vendor/jquery-validate/additional-methods.js') }}
{{ asset_js('js/vendor/jquery-validate/localization/messages_fr.js') }}
{{ asset_js('js/plugins/plugin-validator.js') }}
{{ asset_js('js/plugins/plugin-validator_fr.js') }}
{% else %}
{{ asset_js('js/core_edit.js') }}
{% endif %}
{%- endblock %}
